<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Write My First Game: MineSweeper | Hendryshi's Blog</title><meta name="author" content="Hendryshi"><meta name="copyright" content="Hendryshi"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="This is my first game developed by C# WinForm platform. The initial object is to practice my C# level. So the first game jump into my mind is “MineSweeper”. It is enough simple and interesting. In thi">
<meta property="og:type" content="article">
<meta property="og:title" content="Write My First Game: MineSweeper">
<meta property="og:url" content="https://blog.hendryshi.com/post/ac55a180.html">
<meta property="og:site_name" content="Hendryshi&#39;s Blog">
<meta property="og:description" content="This is my first game developed by C# WinForm platform. The initial object is to practice my C# level. So the first game jump into my mind is “MineSweeper”. It is enough simple and interesting. In thi">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://img.hendryshi.com/i/2023/04/6431bb7ddc525.webp">
<meta property="article:published_time" content="2020-04-30T22:00:00.000Z">
<meta property="article:modified_time" content="2023-04-08T19:49:24.107Z">
<meta property="article:author" content="Hendryshi">
<meta property="article:tag" content="C#">
<meta property="article:tag" content="WinForm">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.hendryshi.com/i/2023/04/6431bb7ddc525.webp"><link rel="shortcut icon" href="/img/avatar.jpg"><link rel="canonical" href="https://blog.hendryshi.com/post/ac55a180.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"IWD1U7U0VP","apiKey":"6229f978b678dc3ffc55e363ca0450d1","indexName":"BlogSearch","hits":{"per_page":10},"languages":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}.","hits_stats":"${hits} results found in ${time} ms"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: false,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Write My First Game: MineSweeper',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-04-08 21:49:24'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "/img/friend_404.gif" data-lazy-src="https://img.hendryshi.com/i/2023/03/641f67844bf1f.webp" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img fixed" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Hendryshi's Blog"><span class="site-name">Hendryshi's Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">Write My First Game: MineSweeper</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2020-04-30T22:00:00.000Z" title="Created 2020-05-01 00:00:00">2020-05-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-04-08T19:49:24.107Z" title="Updated 2023-04-08 21:49:24">2023-04-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Project/">Project</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">2.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>15min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Write My First Game: MineSweeper"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">Comments:</span><span class="disqus-comment-count"><a href="https://blog.hendryshi.com/post/ac55a180.html#disqus_thread"><i class="fa-solid fa-spinner fa-spin"></i></a></span></span></div></div></div><article class="post-content" id="article-container"><p>This is my first game developed by C# WinForm platform. The initial object is to practice my C# level. So the first game jump into my mind is “MineSweeper”. It is enough simple and interesting. In this post I will list my conception and some difficult point during my development.</p>
<p><strong>To see my <a target="_blank" rel="noopener" href="https://github.com/Hendryshi/MineSweeper">MineSweeper project</a> in github.</strong></p>
<p><strong>See also <a target="_blank" rel="noopener" href="http://www.freeminesweeper.org/help/minehelpinstructions.html">the rule for mineSweeper</a></strong></p>
<span id="more"></span>

<h1 id="Class-Conception"><a href="#Class-Conception" class="headerlink" title="Class Conception"></a>Class Conception</h1><p><img src= "/img/friend_404.gif" data-lazy-src="https://img.hendryshi.com/i/2023/04/6431bb706b0bd.webp" alt="class"></p>
<p>In this application three main objects are used in models:</p>
<ul>
<li><p>Class <code>Game</code> presents one game, every time when we create or restart a new game, this class is created. Trough this class we have the proprieties like <code>gameResults</code>, <code>flagCounts</code> and <code>gameLevel</code>.</p>
</li>
<li><p>Class <code>Square</code> presents every single squares on the board, it is applied to a two-dimension array in class <code>Game</code>. In this class, we have the proprieties like the value of square (-1 for mined, and [0-9] for others), the position in the boards. Also I use an enumeration &#96;&#96; to define the status of square(open, close, flagged…)</p>
</li>
<li><p>Class <code>Frame</code> presents the board on the interface. this class takes charges of the drawing function. Every drawing function return a temporary bitmap picture in the backend, and the front interface cover this bitmap to itself.</p>
</li>
</ul>
<h1 id="Program-process"><a href="#Program-process" class="headerlink" title="Program process"></a>Program process</h1><p><img src= "/img/friend_404.gif" data-lazy-src="https://img.hendryshi.com/i/2023/04/6431bb9827d21.webp" alt="process"></p>
<p>As described as above, every time when we click the mouse, the program enter into different functions defined in object <code>Game</code> according to the different mouse event (left click, right click or both click). And at the end of every function, we call the function drawing in <code>Frame</code> to refresh our frontend interface.</p>
<h1 id="Some-focal-points-in-my-development"><a href="#Some-focal-points-in-my-development" class="headerlink" title="Some focal points in my development"></a>Some focal points in my development</h1><h2 id="Different-mouse-events"><a href="#Different-mouse-events" class="headerlink" title="Different mouse events"></a>Different mouse events</h2><p>In the program, I use many different mouse events. I’d like to list as below by raising order. You can find the completely mouse events definitions <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/dotnet/framework/winforms/mouse-events-in-windows-forms"><strong>here</strong></a>.</p>
<p>Note that in my program, I don’t know it’s which click are mouse down or up, I use two properties <code>leftDown</code> and <code>rightDown</code> to keep and record the status of my clicks.</p>
<ul>
<li><p><strong>MouseMove event</strong>: This function is raised when your mouse’s position are changed.</p>
<p>  I use this event to realize that when I keep holding my left click and moving on the board, all passing squares are pressed down.</p>
  <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">pnlMine_MouseMove</span>(<span class="params"><span class="built_in">object</span> sender, MouseEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(game.InGameSize(e.Location) &amp;&amp; !game.Result.HasValue)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(leftDown)</span><br><span class="line">        &#123;</span><br><span class="line">            game.SetSquaresDown(e.Location, rightDown);</span><br><span class="line">            RefreshFrame();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>MouseDown event</strong>: This function is called when your mouse is clicked down</p>
<p>  I use this function to add flag if it’s the right click, also if left click, I will set the property <code>leftDown</code> to be true and use it in mouseUp function later.</p>
  <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">pnlMine_MouseDown</span>(<span class="params"><span class="built_in">object</span> sender, MouseEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!game.Result.HasValue)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">switch</span>(e.Button)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> MouseButtons.Left:</span><br><span class="line">                leftDown = <span class="literal">true</span>;</span><br><span class="line">                game.SetSquaresDown(e.Location, rightDown);</span><br><span class="line">                game.ChangeFace(GameFace.MouthOpen);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MouseButtons.Right:</span><br><span class="line">                rightDown = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">if</span>(!leftDown)</span><br><span class="line">                    game.AddRemoveFlag(e.Location);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(leftDown &amp;&amp; rightDown &amp;&amp; game.InGameSize(e.Location))</span><br><span class="line">            game.SetSquaresDown(e.Location, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        RefreshFrame();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>MouseClick event</strong>: This function is called after function MouseDown</p>
<p>  This function is the most common mouse event, I use it to open a single square if it’s left click.</p>
  <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">pnlMine_MouseClick</span>(<span class="params"><span class="built_in">object</span> sender, MouseEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(e.Button == MouseButtons.Left &amp;&amp; (!leftDown || !rightDown) &amp;&amp; game.InGameSize(e.Location) &amp;&amp; !game.Result.HasValue)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!game.IsStart)</span><br><span class="line">        &#123;</span><br><span class="line">            game.StartGame(e.Location);</span><br><span class="line">            threadTimer.Change(<span class="number">0</span>, <span class="number">1000</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        game.OpenSingleSquare(e.Location);</span><br><span class="line">        RefreshFrame();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p><strong>MouseUp event</strong>: This function is called the moment when your mouse is click up (the position of click up). </p>
<p>  I use this function to open around squares if it’s both click (leftDown &amp;&amp; rightDown)</p>
  <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">pnlMine_MouseUp</span>(<span class="params"><span class="built_in">object</span> sender, MouseEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!game.Result.HasValue)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(leftDown &amp;&amp; rightDown &amp;&amp; game.InGameSize(e.Location))</span><br><span class="line">            game.OpenAroundSquares(e.Location);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span>(e.Button)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> MouseButtons.Left:</span><br><span class="line">                leftDown = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> MouseButtons.Right:</span><br><span class="line">                rightDown = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        game.SetAllSquaresUp();</span><br><span class="line">        game.ChangeFace(GameFace.SmileUp);</span><br><span class="line">        RefreshFrame();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="The-drawing-jobs"><a href="#The-drawing-jobs" class="headerlink" title="The drawing jobs"></a>The drawing jobs</h2><p>As this is my first winForm application, I know few about the <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/win32/gdiplus/-gdiplus-gdi-start"><strong>windows GDI+ technology</strong></a>, fortunately the drawing functions I use in my application is simple enough. </p>
<ul>
<li><p><strong>Create the frame</strong>:</p>
<p>  <img src= "/img/friend_404.gif" data-lazy-src="https://img.hendryshi.com/i/2023/04/6431bbae9c7a2.webp" alt="frame"></p>
<p>  When the game is started, the first thing we do is to create the entire frame, To realize that, I created three empty bitmap as temporary buffer image (one for info panel, one for mine panel, and one for main panel) in the frame object. They all have the same size as the frontend frame</p>
  <figure class="highlight csharp"><figcaption><span>Create a new bitmap and initialize it by color Gray</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">bufferMainFrame = <span class="keyword">new</span> Bitmap(rctGameField.Width, rctGameField.Height);</span><br><span class="line">bufferInfoFrame = <span class="keyword">new</span> Bitmap(rctPnlInfo.Width, rctPnlInfo.Height);</span><br><span class="line">bufferTimerFrame = <span class="keyword">new</span> Bitmap(rctPnlTimer.Width, rctPnlTimer.Height);</span><br><span class="line">bufferMineFrame = <span class="keyword">new</span> Bitmap(rctPnlMine.Width, rctPnlMine.Height);</span><br><span class="line"></span><br><span class="line">Graphics.FromImage(bufferMainFrame).Clear(GRAY);</span><br><span class="line">Graphics.FromImage(bufferInfoFrame).Clear(GRAY);</span><br><span class="line">Graphics.FromImage(bufferTimerFrame).Clear(GRAY);</span><br><span class="line">Graphics.FromImage(bufferMineFrame).Clear(GRAY);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>The function <code>Graphics.FromImage(bufferMineFrame)</code> can get the brush of this image.<br>The function <code>Graphics.Clear(GRAY)</code> can clear a picture by a specified color (Gray in here).</p>
</blockquote>
</li>
<li><p><strong>Draw the squares</strong>:</p>
<p>  In the game, you need to open squares with different value. According to the different value of square, you need to draw different image on the specified position of the temporary image.</p>
  <figure class="highlight csharp"><figcaption><span>Function Draw Square</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Bitmap <span class="title">DrawSquare</span>(<span class="params">Square square</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    Graphics g = Graphics.FromImage(bufferMineFrame);</span><br><span class="line">    <span class="built_in">int</span> srcY = (<span class="built_in">int</span>)square.Status + (square.Status == MineStatus.OpenedNumber ? (Square.MaxSquareNum - square.Value) * ImgMineUnitWidth : <span class="number">0</span>);</span><br><span class="line">    Rectangle mineRect = <span class="keyword">new</span> Rectangle(square.Location, <span class="keyword">new</span> Size(squareSize, squareSize));</span><br><span class="line">    Rectangle srcRect = <span class="keyword">new</span> Rectangle(<span class="keyword">new</span> Point(<span class="number">0</span>, srcY), <span class="keyword">new</span> Size(ImgMineUnitWidth, ImgMineUnitWidth));</span><br><span class="line"></span><br><span class="line">    GraphicsUnit units = GraphicsUnit.Pixel;</span><br><span class="line">    g.DrawImage(imgMine, mineRect, srcRect, units);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> bufferMineFrame;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Function <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/dotnet/api/system.drawing.graphics.drawimage?view=dotnet-plat-ext-3.1"><strong>Graphic.DrawImage</strong></a> can draw a specified image on the target frame.<br><code>imgMine</code> is your image that you choose to put on the target frame, <code>srcRect</code> is the part of your image (imgMine).
  </p>
</blockquote>
</li>
<li><p><strong>Refresh the square on the board</strong>:<br>  As some of you may ask why you have to draw on the temporary bitmap and cover it to the frontend interface ? why we cannot draw the image directly on the frontend board ?</p>
<blockquote>
<p>There are two reasons:<br>The first is that in my opinion the logic to draw and refresh the image are something in the backend, The frontend interface only call the function in the backend to refresh its frame.  </p>
<p>The second and more important reason is that if we draw the image directly in frontend frame, when many squares are updated in one time, every seconds the frame is being drawn, that will cause a blink effect. So we choose to draw all the squares in a temporary buffer picture and apply it to the frontend frame only one time. </p>
</blockquote>
  <figure class="highlight csharp"><figcaption><span>Function to apply the temporary image to the frontend frame</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">RefreshFrame</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    pnlMine.CreateGraphics().DrawImage(game.GameFrame.MineFrame, ClientRectangle.Location);</span><br><span class="line">    pnlInfo.CreateGraphics().DrawImage(game.GameFrame.InfoFrame, ClientRectangle.Location);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="The-function-to-open-the-square"><a href="#The-function-to-open-the-square" class="headerlink" title="The function to open the square"></a>The function to open the square</h2><ul>
<li>There are two ways to open the squares, one is to left click a closed square, the around 8 squares need to open if the value equals to 0</li>
<li>The other is to both click an opened square, if it has the same count of flag around it as the value of this square, they need to be expanded also.</li>
<li>Both two ways need a recursive function</li>
</ul>
<figure class="highlight csharp"><figcaption><span>Recursive function</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">ExpandSquares</span>(<span class="params">Square sq</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">bool</span> noError = <span class="literal">true</span>;</span><br><span class="line">    List&lt;Square&gt; lstAroundSquare = sq.GetAroundSquare(squares, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span>(Square sqAround <span class="keyword">in</span> lstAroundSquare)</span><br><span class="line">    &#123;</span><br><span class="line">        noError &amp;= sqAround.OpenSquare();</span><br><span class="line">        gameFrame.DrawSquare(sqAround);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(sqAround.Value == <span class="number">0</span>)</span><br><span class="line">            noError &amp;= ExpandSquares(sqAround);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> noError;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight csharp"><figcaption><span>Function to get the around squares according different condition</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Square&gt; <span class="title">GetAroundSquare</span>(<span class="params">Square[,] squares, <span class="built_in">bool</span> excludeMine = <span class="literal">false</span>, <span class="built_in">bool</span> excludeOpen = <span class="literal">false</span></span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> query = <span class="keyword">from</span> Square sq <span class="keyword">in</span> squares </span><br><span class="line">                <span class="keyword">where</span> sq.location.X &gt;= <span class="keyword">this</span>.location.X - squareSize &amp;&amp; sq.location.X &lt;= <span class="keyword">this</span>.location.X + squareSize</span><br><span class="line">                &amp;&amp; sq.location.Y &gt;= <span class="keyword">this</span>.location.Y - squareSize &amp;&amp; sq.location.Y &lt;= <span class="keyword">this</span>.location.Y + squareSize</span><br><span class="line">                &amp;&amp; sq.location != <span class="keyword">this</span>.location</span><br><span class="line">                <span class="keyword">select</span> sq;</span><br><span class="line">    <span class="keyword">if</span>(excludeMine)</span><br><span class="line">        query = query.ToList().Where(sq =&gt; !sq.IsMine());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(excludeOpen)</span><br><span class="line">        query = query.ToList().Where(sq =&gt; sq.IsClosed());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> query.ToList();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Yates-shuffle-Algorithm"><a href="#Yates-shuffle-Algorithm" class="headerlink" title="Yates shuffle Algorithm"></a>Yates shuffle Algorithm</h2><figure class="highlight csharp"><figcaption><span>Algorithm global</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="built_in">int</span> i = n<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">    swap(arr[i], arr[rand() % (i+<span class="number">1</span>)])</span><br></pre></td></tr></table></figure>
<ul>
<li>At start of game, you need to set randomly the mines on the board. And set the value of each square according to the mine count around it.</li>
<li>In my application, I use the algorithm Yates shuffle to set my mines. I suppose that in my square array, the first k squares are mines (k is your mine count), and I switch my arr[i] square with a random(arr[0] ~ arr[i-1]) square. And do this for n times. (n is your total squares)</li>
<li>After you have set your mines, you need to parse all your mine, and set the value of around square &#x3D; value + 1.</li>
<li>The difficulty is that the first click of a game cannot be a mine. So that change my algorithm. I can only set my mines and value of other squares after the first click on the board. Moreover, the click square should only be 0 so that it can expand a block of squares around it (the around square should not be mine). To solve this problem, I change my function as below</li>
</ul>
<figure class="highlight csharp"><figcaption><span>The function of Yates shuffle</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">KnuthShuffleMine</span>(<span class="params">Point point</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Random ran = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="built_in">int</span> indexX = point.X / squareSize;</span><br><span class="line">        <span class="built_in">int</span> indexY = point.Y / squareSize;</span><br><span class="line">        Square sqPoint = squares[indexX, indexY];</span><br><span class="line"></span><br><span class="line">        <span class="built_in">int</span> indexOffset = sqPoint.GetAroundMineCount(squares) + (sqPoint.IsMine() ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">int</span> y = <span class="number">0</span>; y &lt;= squares.GetLength(<span class="number">1</span>) - <span class="number">1</span>; y++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="built_in">int</span> x = <span class="number">0</span>; x &lt;= squares.GetLength(<span class="number">0</span>) - <span class="number">1</span>; x++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// this area cannot be mine</span></span><br><span class="line">                <span class="keyword">if</span>(x &gt;= indexX - <span class="number">1</span> &amp;&amp; x &lt;= indexX + <span class="number">1</span> &amp;&amp; y &gt;= indexY - <span class="number">1</span> &amp;&amp; y &lt;= indexY + <span class="number">1</span>)</span><br><span class="line">                    squares[x, y].Value = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    Point ranP = GetRandomPoint(ran, x, y, indexX, indexY);</span><br><span class="line">                    <span class="built_in">int</span> ranSquareValue = ranP.Y * squares.GetLength(<span class="number">0</span>) + ranP.X &lt; mineCount + indexOffset ? <span class="number">-1</span> : squares[ranP.X, ranP.Y].Value;</span><br><span class="line"></span><br><span class="line">                    <span class="built_in">int</span> <span class="keyword">value</span> = y * squares.GetLength(<span class="number">0</span>) + x &lt; mineCount + indexOffset ? <span class="number">-1</span> : squares[x, y].Value;</span><br><span class="line">                    squares[x, y].Value = ranSquareValue;</span><br><span class="line">                    squares[ranP.X, ranP.Y].Value = <span class="keyword">value</span>;</span><br><span class="line">                    gameFrame.DrawSquare(squares[x, y]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> queryMine = <span class="keyword">from</span> Square sq <span class="keyword">in</span> squares</span><br><span class="line">                        <span class="keyword">where</span> sq.IsMine()</span><br><span class="line">                        <span class="keyword">select</span> sq;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span>(Square sq <span class="keyword">in</span> queryMine)</span><br><span class="line">        &#123;</span><br><span class="line">            List&lt;Square&gt; lstAroundSquare = sq.GetAroundSquare(squares, <span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">foreach</span>(Square sqAround <span class="keyword">in</span> lstAroundSquare)</span><br><span class="line">            &#123;</span><br><span class="line">                sqAround.Value += <span class="number">1</span>;</span><br><span class="line">                gameFrame.DrawSquare(sqAround);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight csharp"><figcaption><span>The function to get random point</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Point <span class="title">GetRandomPoint</span>(<span class="params">Random random, <span class="built_in">int</span> x, <span class="built_in">int</span> y, <span class="built_in">int</span> indexX, <span class="built_in">int</span> indexY</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> ranX;</span><br><span class="line">    <span class="built_in">int</span> ranY;</span><br><span class="line">    <span class="built_in">int</span> ranT;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        ranT = random.Next(y * squares.GetLength(<span class="number">0</span>) + x, squares.GetLength(<span class="number">0</span>) * squares.GetLength(<span class="number">1</span>) - <span class="number">1</span>);</span><br><span class="line">        ranX = ranT % squares.GetLength(<span class="number">0</span>);</span><br><span class="line">        ranY = ranT / squares.GetLength(<span class="number">0</span>);</span><br><span class="line">    &#125; <span class="keyword">while</span>(ranX &gt;= indexX - <span class="number">1</span> &amp;&amp; ranX &lt;= indexX + <span class="number">1</span> &amp;&amp; ranY &gt;= indexY - <span class="number">1</span> &amp;&amp; ranY &lt;= indexY + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Point(ranX, ranY);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>You can find more introduce for this algorithm <a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1462951"><strong>here</strong></a></p>
</blockquote>
<h2 id="ThreadTimer-function"><a href="#ThreadTimer-function" class="headerlink" title="ThreadTimer function"></a>ThreadTimer function</h2><p>Also, in my game I need a timer to record my scores, and the time should be changed every seconds in the frontend interface. In winForm application there are three methods to create a timer, here I use the <code>System.Threading.Timer</code>, as it create a different thread from the main tread, so it’s the most accurate timer comparing to the other two methods. </p>
<figure class="highlight csharp"><figcaption><span>When create a new game</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(threadTimer != <span class="literal">null</span>)</span><br><span class="line">    threadTimer.Dispose();</span><br><span class="line"></span><br><span class="line">threadTimer = <span class="keyword">new</span> System.Threading.Timer(<span class="keyword">new</span> TimerCallback(ChangeTime), <span class="literal">null</span>, Timeout.Infinite, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Function <code>new System.Threading.Timer(new TimerCallback(ChangeTime), null, Timeout.Infinite, 1000)</code> create a new instance of Timer object.<br>The parameter <code>new TimerCallback(ChangeTime)</code> is the function (in this case <code>ChangeTime</code>) raised every interval time.<br>The parameter <code>null</code> is your parameter of your raised function. In my function I have no parameter to parse, so it’s null.<br>The parameter <code>Timeout.Infinite</code> is the start time of your timer function. If you want to start the timer right now, you can set it to 0.<br>The last parameter is the interval of timer. In my case it’s 1000 mille seconds.</p>
</blockquote>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">delegate</span> <span class="keyword">void</span> <span class="title">MyInvoke</span>()</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ChangeTime</span>(<span class="params"><span class="built_in">object</span> <span class="keyword">value</span></span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!game.Result.HasValue)</span><br><span class="line">    &#123;</span><br><span class="line">        game.ChangeTime();</span><br><span class="line">        pnlTimer.CreateGraphics().DrawImage(game.GameFrame.TimerFrame, ClientRectangle.Location);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        threadTimer.Dispose();</span><br><span class="line">        <span class="keyword">if</span>(game.Result == <span class="literal">true</span> &amp;&amp; game.CheckBreakRecord())</span><br><span class="line">        &#123;</span><br><span class="line">            MyInvoke mi = <span class="keyword">new</span> MyInvoke(SetNewRecords);</span><br><span class="line">            BeginInvoke(mi);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>To note that, as the timer uses a different thread from the main thread, If you want to call&#x2F;raise the controls in your main thread in this timer function, you need to create another Invoke and use your main thread’s controls in this Invoke, otherwise the program will raise an error.</p>
</blockquote>
<h2 id="Fix-and-center-my-form-size"><a href="#Fix-and-center-my-form-size" class="headerlink" title="Fix and center my form size"></a>Fix and center my form size</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen;</span><br><span class="line"><span class="keyword">this</span>.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedSingle;</span><br><span class="line"><span class="keyword">this</span>.MaximizeBox = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>

<div class="note warning modern no-icon flat"><p><strong>This code should be put in Form.Designer.cs</strong></p>
</div>

<h2 id="Save-my-score-when-breaking-records"><a href="#Save-my-score-when-breaking-records" class="headerlink" title="Save my score when breaking records"></a>Save my score when breaking records</h2><p>To save my scores, I use the property of userSetting. The differences between userSetting and appSetting is that appSetting cannot be modified in the program, but with userSetting you can change it or load it in your program.</p>
<p>You need to define your all setting properties in your setting.cs file.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">SetNewRecords</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(level == GameLevel.Beginner)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.rankBegItem.Text = <span class="string">&quot;Beginner: &quot;</span> + game.TimeRecord;</span><br><span class="line">        Properties.Settings.Default[<span class="string">&quot;BegRecord&quot;</span>] = game.TimeRecord;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(level == GameLevel.Intermediate)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.rankInterItem.Text = <span class="string">&quot;Intermediate: &quot;</span> + game.TimeRecord;</span><br><span class="line">        Properties.Settings.Default[<span class="string">&quot;InterRecord&quot;</span>] = game.TimeRecord;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(level == GameLevel.Expert)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.rankExpertItem.Text = <span class="string">&quot;Expert: &quot;</span> + game.TimeRecord;</span><br><span class="line">        Properties.Settings.Default[<span class="string">&quot;ExpertRecord&quot;</span>] = game.TimeRecord;</span><br><span class="line">    &#125;</span><br><span class="line">    Properties.Settings.Default.Save();</span><br><span class="line">    MessageBox.Show(<span class="string">&quot;You have break a new records: &quot;</span> + game.TimeRecord);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>To load your setting property :<br><code>game.TimeRecord = Properties.Settings.Default[&quot;InterRecord&quot;]</code><br>To save your setting property :<br><code>Properties.Settings.Default[&quot;InterRecord&quot;] = game.TimeRecord;</code><br><code>Properties.Settings.Default.Save();</code></p>
</blockquote>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>This is my first personal game developed by C# winForm. At first I think that it’s easy to develop, but in fact I still met some difficulties and it took me about two weeks to finish it. Maybe in the future I would add some another features like music and animation effect to my application.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://blog.hendryshi.com">Hendryshi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://blog.hendryshi.com/post/ac55a180.html">https://blog.hendryshi.com/post/ac55a180.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/C/">C#</a><a class="post-meta__tags" href="/tags/WinForm/">WinForm</a></div><div class="post_share"><div class="social-share" data-image="https://img.hendryshi.com/i/2023/04/6431bb7ddc525.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/3ee492a7.html" title="Some tips when using GROUP BY in SQL Server"><img class="cover" src= "/img/friend_404.gif" data-lazy-src="https://img.hendryshi.com/i/2023/04/6431b69f23c17.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Some tips when using GROUP BY in SQL Server</div></div></a></div><div class="next-post pull-right"><a href="/post/e4c83362.html" title="Hexo Tutorial"><img class="cover" src= "/img/friend_404.gif" data-lazy-src="https://img.hendryshi.com/i/2023/04/6431b5ec67e6e.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Hexo Tutorial</div></div></a></div></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "/img/friend_404.gif" data-lazy-src="https://img.hendryshi.com/i/2023/03/641f67844bf1f.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Hendryshi</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Hendryshi" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:ysi.shiyejia@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Class-Conception"><span class="toc-number">1.</span> <span class="toc-text">Class Conception</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Program-process"><span class="toc-number">2.</span> <span class="toc-text">Program process</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Some-focal-points-in-my-development"><span class="toc-number">3.</span> <span class="toc-text">Some focal points in my development</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Different-mouse-events"><span class="toc-number">3.1.</span> <span class="toc-text">Different mouse events</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-drawing-jobs"><span class="toc-number">3.2.</span> <span class="toc-text">The drawing jobs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-function-to-open-the-square"><span class="toc-number">3.3.</span> <span class="toc-text">The function to open the square</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Yates-shuffle-Algorithm"><span class="toc-number">3.4.</span> <span class="toc-text">Yates shuffle Algorithm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ThreadTimer-function"><span class="toc-number">3.5.</span> <span class="toc-text">ThreadTimer function</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fix-and-center-my-form-size"><span class="toc-number">3.6.</span> <span class="toc-text">Fix and center my form size</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Save-my-score-when-breaking-records"><span class="toc-number">3.7.</span> <span class="toc-text">Save my score when breaking records</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Conclusion"><span class="toc-number">4.</span> <span class="toc-text">Conclusion</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/bec7bf7f.html" title="Git fork and synchronize"><img src= "/img/friend_404.gif" data-lazy-src="https://img.hendryshi.com/i/2023/03/6420800633c2b.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Git fork and synchronize"/></a><div class="content"><a class="title" href="/post/bec7bf7f.html" title="Git fork and synchronize">Git fork and synchronize</a><time datetime="2023-06-13T21:18:24.000Z" title="Created 2023-06-13 23:18:24">2023-06-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/e7994309.html" title="Docker Formation Notes"><img src= "/img/friend_404.gif" data-lazy-src="https://img.hendryshi.com/i/2023/04/6431c79d67ba8.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Docker Formation Notes"/></a><div class="content"><a class="title" href="/post/e7994309.html" title="Docker Formation Notes">Docker Formation Notes</a><time datetime="2023-01-29T11:23:57.000Z" title="Created 2023-01-29 12:23:57">2023-01-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/7eb7aa8d.html" title="Driving Lesson Study Summary(Automatical)"><img src= "/img/friend_404.gif" data-lazy-src="https://img.hendryshi.com/i/2023/04/6431bd987b45d.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Driving Lesson Study Summary(Automatical)"/></a><div class="content"><a class="title" href="/post/7eb7aa8d.html" title="Driving Lesson Study Summary(Automatical)">Driving Lesson Study Summary(Automatical)</a><time datetime="2022-08-15T19:07:22.000Z" title="Created 2022-08-15 21:07:22">2022-08-15</time></div></div></div></div></div></div></main><footer id="footer" style="background: #434748"><div id="footer-wrap"><div class="copyright">&copy;2023 By Hendryshi</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>function loadDisqus () {
  const disqus_config = function () {
    this.page.url = 'https://blog.hendryshi.com/post/ac55a180.html'
    this.page.identifier = '/post/ac55a180.html'
    this.page.title = 'Write My First Game: MineSweeper'
  }

  const disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  btf.addModeChange('disqus', disqusReset)

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Disqus' === 'Disqus' || !false) {
  if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script><script>if (window.DISQUSWIDGETS === undefined) {
  var d = document, s = d.createElement('script');
  s.src = 'https://.disqus.com/count.js';
  s.id = 'dsq-count-scr';
  (d.head || d.body).appendChild(s);
} else {
  DISQUSWIDGETS.getCount({reset: true});
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/algoliasearch-lite.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script></div></div></body></html>